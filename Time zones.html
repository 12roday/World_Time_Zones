<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>World Time Zones</title>
<style>
body {
  margin: 0;
  font-family: "Segoe UI", Arial, sans-serif;
  background: #f4f7fb;
  display: flex;
  min-height: 100vh;
  overflow: hidden;
}
header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: #007bff;
  color: white;
  text-align: center;
  padding: 20px;
  font-size: 28px;
  font-weight: bold;
  z-index: 10;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}
main {
  flex: 1;
  margin-top: 80px;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  gap: 40px;
  padding: 40px;
}
.search-container {
  background: white;
  padding: 40px;
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  text-align: center;
  flex: 1;
  max-width: 600px;
  position: relative;
}
input {
  padding: 18px;
  width: 100%;
  border: 2px solid #007bff;
  border-radius: 10px;
  font-size: 20px;
  margin-bottom: 20px;
  outline: none;
}
button {
  padding: 14px 28px;
  font-size: 18px;
  background: #007bff;
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: 0.3s;
}
button:hover { background: #0056b3; }
#results {
  margin-top: 25px;
  font-size: 18px;
  text-align: left;
}
.tz-item {
  position: relative;
  padding: 12px 12px 12px 16px;
  border: 1px solid #ddd;
  border-radius: 10px;
  margin-bottom: 12px;
  background: #f9fbff;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.tz-item button.star {
  background: transparent;
  border: none;
  font-size: 20px;
  cursor: pointer;
  color: #ccc;
  transition: 0.3s;
}
.tz-item button.star.saved { color: gold; }
aside {
  width: 280px;
  background: white;
  border-left: 2px solid #ddd;
  padding: 20px;
  overflow-y: auto;
}
aside h2 {
  font-size: 20px;
  margin-bottom: 15px;
  color: #007bff;
  text-align: center;
}
.favorite {
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 8px;
  margin-bottom: 12px;
  font-size: 16px;
  background: #f9fbff;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.settings-button {
  position: fixed;
  bottom: 20px;
  right: 20px;
  padding: 10px 15px;
  font-size: 18px;
  border-radius: 10px;
  background: #007bff;
  color: white;
  cursor: pointer;
  border: none;
  z-index: 1000;
}
#settingsModal {
  position: fixed;
  bottom: 60px;
  right: 20px;
  background: white;
  border: 1px solid #007bff;
  border-radius: 10px;
  padding: 20px;
  display: none;
  z-index: 1001;
  width: 200px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}
#settingsModal label { display: block; margin: 10px 0 5px; }
#settingsModal select { width: 100%; padding: 5px; border-radius: 5px; }
</style>
</head>
<body>
<header id="headerTitle">World Time Zones</header>
<main>
  <div class="search-container">
    <input type="text" id="searchBox" placeholder="Enter a country, state, or city...">
    <br>
    <button id="searchBtn">Search</button>
    <div id="results"></div>
  </div>
  <aside>
    <h2 id="savedTitle">⭐ Saved</h2>
    <div id="favorites"></div>
  </aside>
</main>

<button class="settings-button" onclick="toggleSettings()">⚙️</button>
<div id="settingsModal">
  <label for="clockFormat">Clock Format:</label>
  <select id="clockFormat">
    <option value="12">12-hour</option>
    <option value="24">24-hour</option>
  </select>
  <label for="languageSelect">Language:</label>
  <select id="languageSelect">
    <option value="en">English</option>
    <option value="zh">Chinese</option>
    <option value="ja">Japanese</option>
    <option value="hi">Hindi</option>
    <option value="pt">Portuguese</option>
  </select>
</div>

<script>
// region/city mapping
const regionTimeZones = {
  "texas":"America/Chicago","california":"America/Los_Angeles","new york":"America/New_York","florida":"America/New_York","alaska":"America/Anchorage","hawaii":"Pacific/Honolulu",
  "malaysia":"Asia/Kuala_Lumpur","kuala lumpur":"Asia/Kuala_Lumpur","penang":"Asia/Kuala_Lumpur","johor":"Asia/Kuala_Lumpur",
  "indonesia":"Asia/Jakarta","jakarta":"Asia/Jakarta","bali":"Asia/Makassar","surabaya":"Asia/Jakarta",
  "hong kong":"Asia/Hong_Kong",
  "argentina":"America/Argentina/Buenos_Aires","buenos aires":"America/Argentina/Buenos_Aires",
  "china":"Asia/Shanghai","beijing":"Asia/Shanghai","shanghai":"Asia/Shanghai","guangdong":"Asia/Shanghai","sichuan":"Asia/Shanghai",
  "india":"Asia/Kolkata","delhi":"Asia/Kolkata","mumbai":"Asia/Kolkata","bangalore":"Asia/Kolkata","kolkata":"Asia/Kolkata",
  "japan":"Asia/Tokyo","tokyo":"Asia/Tokyo","osaka":"Asia/Tokyo","kyoto":"Asia/Tokyo"
};

const favoritesTimers={};
const searchBox=document.getElementById("searchBox");
const searchBtn=document.getElementById("searchBtn");
const clockSelect=document.getElementById("clockFormat");
const langSelect=document.getElementById("languageSelect");
const settingsModal=document.getElementById("settingsModal");
const headerTitle=document.getElementById("headerTitle");
const savedTitle=document.getElementById("savedTitle");

// translations
const translations={
  en: { title:"World Time Zones", saved:"⭐ Saved", placeholder:"Enter a country, state, or city...", search:"Search" },
  zh: { title:"世界时区", saved:"⭐ 已保存", placeholder:"输入国家、州或城市...", search:"搜索" },
  ja: { title:"世界のタイムゾーン", saved:"⭐ 保存済み", placeholder:"国、州、または都市を入力...", search:"検索" },
  hi: { title:"विश्व समय क्षेत्र", saved:"⭐ सहेजा गया", placeholder:"एक देश, राज्य, या शहर दर्ज करें...", search:"खोज" },
  pt: { title:"Fusos horários mundiais", saved:"⭐ Salvo", placeholder:"Digite um país, estado ou cidade...", search:"Pesquisar" }
};

// load preferences
let clockPref=localStorage.getItem("clockFormat")||"12";
let langPref=localStorage.getItem("langPref")||"en";
clockSelect.value=clockPref;
langSelect.value=langPref;

function capitalize(str){return str.replace(/\b\w/g,c=>c.toUpperCase());}

function updateUIText(){
  const t=translations[langSelect.value]||translations.en;
  headerTitle.textContent=t.title;
  savedTitle.textContent=t.saved;
  searchBox.placeholder=t.placeholder;
  searchBtn.textContent=t.search;
  updateAllFavorites();
}

// search and display
function formatTime(tz,name){
  const now=new Date();
  const opts={timeZone:tz,hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",year:"numeric",month:"short",day:"numeric"};
  opts.hour12 = clockSelect.value==="12";
  return `${capitalize(name)} — ${new Intl.DateTimeFormat([],opts).format(now)}`;
}

function searchTimeZones(){
  const input=searchBox.value.trim().toLowerCase();
  const resultsDiv=document.getElementById("results");
  resultsDiv.innerHTML="";
  let matches=[];
  if(regionTimeZones[input]) matches.push({name:input, tz:regionTimeZones[input]});
  else matches=Intl.supportedValuesOf('timeZone').filter(tz=>tz.toLowerCase().includes(input)).map(tz=>({name:tz, tz:tz}));
  if(!matches.length){resultsDiv.innerHTML="❌ No matches found.";return;}
  matches.forEach(match=>{
    const item=document.createElement("div"); item.className="tz-item";
    const span=document.createElement("span"); span.textContent=formatTime(match.tz,match.name);
    const star=document.createElement("button"); star.className="star"; star.innerHTML="★";
    star.onclick=()=>addFavorite(match.name,match.tz,star);
    item.appendChild(span); item.appendChild(star); resultsDiv.appendChild(item);
    setInterval(()=>{span.textContent=formatTime(match.tz,match.name);},1000);
  });
}

function addFavorite(name,tz,button){
  const favoritesDiv=document.getElementById("favorites");
  if(button.classList.contains("saved")){
    button.classList.remove("saved");
    const favItem=favoritesDiv.querySelector(`[data-tz="${tz}"]`);
    if(favItem) favoritesDiv.removeChild(favItem);
    clearInterval(favoritesTimers[tz]);
    delete favoritesTimers[tz];
    return;
  }
  const favItem=document.createElement("div"); favItem.className="favorite"; favItem.dataset.tz=tz;
  const span=document.createElement("span"); span.textContent=formatTime(tz,name);
  const unfav=document.createElement("button"); unfav.innerHTML="★"; unfav.style.background="transparent"; unfav.style.border="none"; unfav.style.color="gold"; unfav.style.cursor="pointer";
  unfav.onclick=()=>{favItem.remove();button.classList.remove("saved");clearInterval(favoritesTimers[tz]);delete favoritesTimers[tz];};
  favItem.appendChild(span); favItem.appendChild(unfav);
  favItem.onclick=()=>{searchBox.value=name; searchTimeZones();};
  favoritesDiv.appendChild(favItem);
  button.classList.add("saved");
  favoritesTimers[tz]=setInterval(()=>{span.textContent=formatTime(tz,name);},1000);
}

function updateAllFavorites(){
  Object.keys(favoritesTimers).forEach(tz=>{
    const favItem=document.querySelector(`.favorite[data-tz="${tz}"] span`);
    if(favItem){
      const name=favItem.textContent.split(" — ")[0];
      favItem.textContent=formatTime(tz,name);
    }
  });
}

function toggleSettings(){ settingsModal.style.display=settingsModal.style.display==="block"?"none":"block"; }

clockSelect.onchange=()=>{
  localStorage.setItem("clockFormat",clockSelect.value);
  updateAllFavorites();
};
langSelect.onchange=()=>{
  localStorage.setItem("langPref",langSelect.value);
  updateUIText();
};

// initialize UI text
updateUIText();

searchBtn.onclick=searchTimeZones;
</script>
</body>
</html>





